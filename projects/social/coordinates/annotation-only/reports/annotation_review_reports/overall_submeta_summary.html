<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Overall Sub-Meta-Analysis Summary</title>
  <style>
    :root {
      --bg: #f7f6f2;
      --panel: #ffffff;
      --ink: #1d2730;
      --line: #d8dde3;
    }
    body { margin: 0; padding: 1.25rem; font-family: "IBM Plex Sans", "Segoe UI", sans-serif; background: var(--bg); color: var(--ink); }
    header, section { background: var(--panel); border: 1px solid var(--line); border-radius: 10px; padding: 1rem; margin-bottom: 1rem; }
    .table-wrap { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
    th, td { border: 1px solid var(--line); padding: 0.45rem; vertical-align: top; text-align: left; }
    th { background: #edf2f5; }
    .metric-bars { min-width: 250px; }
    .metric-row { display: grid; grid-template-columns: 22px 1fr 46px; gap: 0.35rem; align-items: center; margin-bottom: 0.2rem; }
    .metric-label { font-weight: 600; font-size: 0.82rem; }
    .metric-val { font-size: 0.82rem; text-align: right; }
    .bar { height: 0.55rem; border: 1px solid var(--line); border-radius: 999px; overflow: hidden; background: #fbfcfe; }
    .fill { height: 100%; }
    .fill-p { background: #3b82f6; }
    .fill-r { background: #16a34a; }
    .fill-f1 { background: #f59e0b; }
    .confusion-plot { min-width: 220px; }
    .stack-bar { width: 100%; height: 0.78rem; border: 1px solid var(--line); border-radius: 999px; overflow: hidden; background: #fbfcfe; }
    .seg { display: inline-block; height: 100%; }
    .seg-tp { background: #16a34a; }
    .seg-fp { background: #dc2626; }
    .seg-fn { background: #ea580c; }
    .seg-tn { background: #64748b; }
    .legend { margin-top: 0.25rem; font-size: 0.77rem; color: #435164; display: flex; gap: 0.55rem; }
    .lg::before { content: ""; display: inline-block; width: 0.55rem; height: 0.55rem; margin-right: 0.2rem; border-radius: 50%; vertical-align: -1px; }
    .lg-tp::before { background: #16a34a; }
    .lg-fp::before { background: #dc2626; }
    .lg-fn::before { background: #ea580c; }
    .lg-tn::before { background: #64748b; }
    .confusion-plot.empty { font-size: 0.82rem; color: #5a6878; }
  </style>
</head>
<body>
  <header>
    <h1>Overall Sub-Meta-Analysis Summary</h1>
    <p>Study-level evaluation across sub-meta-analyses. A study is included if at least one analysis is included. Universe is PMIDs found in auto <code>outputs/nimads_annotation.json</code>, with manual labels sliced to that same PMID universe.</p>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Aggregate</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Macro (mean over annotations)</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>0.603</td>
            <td>0.879</td>
            <td>0.691</td>
            <td>0.716</td>
          </tr>
          <tr>
            <td>Micro (pooled confusion)</td>
            <td>301</td>
            <td>163</td>
            <td>27</td>
            <td>179</td>
            <td>0.649</td>
            <td>0.918</td>
            <td>0.760</td>
            <td>0.716</td>
          </tr>
        </tbody>
      </table>
    </div>
  </header>
  <section>
    <h2>Per-Annotation Study-Level Metrics</h2>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Annotation</th>
            <th>Auto PMID Universe</th>
            <th>Manual Studies+</th>
            <th>Predicted Studies+</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
            <th>PRF Plot</th>
            <th>Confusion Plot</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>social_processing_all</td><td>134</td><td>134</td><td>132</td><td>132</td><td>0</td><td>2</td><td>0</td><td>1.000</td><td>0.985</td><td>0.992</td><td>0.985</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:100.0%"></div></div><span class="metric-val">1.000</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:98.5%"></div></div><span class="metric-val">0.985</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:99.2%"></div></div><span class="metric-val">0.992</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:98.507%" title="TP=132"></span><span class="seg seg-fp" style="width:0.000%" title="FP=0"></span><span class="seg seg-fn" style="width:1.493%" title="FN=2"></span><span class="seg seg-tn" style="width:0.000%" title="TN=0"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>affiliation_attachment</td><td>134</td><td>19</td><td>60</td><td>16</td><td>44</td><td>3</td><td>71</td><td>0.267</td><td>0.842</td><td>0.405</td><td>0.649</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:26.7%"></div></div><span class="metric-val">0.267</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:84.2%"></div></div><span class="metric-val">0.842</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:40.5%"></div></div><span class="metric-val">0.405</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:11.940%" title="TP=16"></span><span class="seg seg-fp" style="width:32.836%" title="FP=44"></span><span class="seg seg-fn" style="width:2.239%" title="FN=3"></span><span class="seg seg-tn" style="width:52.985%" title="TN=71"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_others</td><td>134</td><td>74</td><td>124</td><td>70</td><td>54</td><td>4</td><td>6</td><td>0.565</td><td>0.946</td><td>0.707</td><td>0.567</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:56.5%"></div></div><span class="metric-val">0.565</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:94.6%"></div></div><span class="metric-val">0.946</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:70.7%"></div></div><span class="metric-val">0.707</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:52.239%" title="TP=70"></span><span class="seg seg-fp" style="width:40.299%" title="FP=54"></span><span class="seg seg-fn" style="width:2.985%" title="FN=4"></span><span class="seg seg-tn" style="width:4.478%" title="TN=6"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_self</td><td>134</td><td>44</td><td>47</td><td>32</td><td>15</td><td>12</td><td>75</td><td>0.681</td><td>0.727</td><td>0.703</td><td>0.799</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:68.1%"></div></div><span class="metric-val">0.681</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:72.7%"></div></div><span class="metric-val">0.727</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:70.3%"></div></div><span class="metric-val">0.703</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:23.881%" title="TP=32"></span><span class="seg seg-fp" style="width:11.194%" title="FP=15"></span><span class="seg seg-fn" style="width:8.955%" title="FN=12"></span><span class="seg seg-tn" style="width:55.970%" title="TN=75"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>social_communication</td><td>134</td><td>57</td><td>101</td><td>51</td><td>50</td><td>6</td><td>27</td><td>0.505</td><td>0.895</td><td>0.646</td><td>0.582</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:50.5%"></div></div><span class="metric-val">0.505</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:89.5%"></div></div><span class="metric-val">0.895</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:64.6%"></div></div><span class="metric-val">0.646</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:38.060%" title="TP=51"></span><span class="seg seg-fp" style="width:37.313%" title="FP=50"></span><span class="seg seg-fn" style="width:4.478%" title="FN=6"></span><span class="seg seg-tn" style="width:20.149%" title="TN=27"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr>
        </tbody>
      </table>
    </div>
  </section>
</body>
</html>
