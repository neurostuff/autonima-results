<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Overall Sub-Meta-Analysis Summary</title>
  <style>
    :root {
      --bg: #f7f6f2;
      --panel: #ffffff;
      --ink: #1d2730;
      --line: #d8dde3;
    }
    body { margin: 0; padding: 1.25rem; font-family: "IBM Plex Sans", "Segoe UI", sans-serif; background: var(--bg); color: var(--ink); }
    header, section { background: var(--panel); border: 1px solid var(--line); border-radius: 10px; padding: 1rem; margin-bottom: 1rem; }
    .table-wrap { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
    th, td { border: 1px solid var(--line); padding: 0.45rem; vertical-align: top; text-align: left; }
    th { background: #edf2f5; }
    .metric-bars { min-width: 250px; }
    .metric-row { display: grid; grid-template-columns: 22px 1fr 46px; gap: 0.35rem; align-items: center; margin-bottom: 0.2rem; }
    .metric-label { font-weight: 600; font-size: 0.82rem; }
    .metric-val { font-size: 0.82rem; text-align: right; }
    .bar { height: 0.55rem; border: 1px solid var(--line); border-radius: 999px; overflow: hidden; background: #fbfcfe; }
    .fill { height: 100%; }
    .fill-p { background: #3b82f6; }
    .fill-r { background: #16a34a; }
    .fill-f1 { background: #f59e0b; }
    .confusion-plot { min-width: 220px; }
    .stack-bar { width: 100%; height: 0.78rem; border: 1px solid var(--line); border-radius: 999px; overflow: hidden; background: #fbfcfe; }
    .seg { display: inline-block; height: 100%; }
    .seg-tp { background: #16a34a; }
    .seg-fp { background: #dc2626; }
    .seg-fn { background: #ea580c; }
    .seg-tn { background: #64748b; }
    .legend { margin-top: 0.25rem; font-size: 0.77rem; color: #435164; display: flex; gap: 0.55rem; }
    .lg::before { content: ""; display: inline-block; width: 0.55rem; height: 0.55rem; margin-right: 0.2rem; border-radius: 50%; vertical-align: -1px; }
    .lg-tp::before { background: #16a34a; }
    .lg-fp::before { background: #dc2626; }
    .lg-fn::before { background: #ea580c; }
    .lg-tn::before { background: #64748b; }
    .confusion-plot.empty { font-size: 0.82rem; color: #5a6878; }
  </style>
</head>
<body>
  <header>
    <h1>Overall Sub-Meta-Analysis Summary</h1>
    <p>Study-level evaluation across sub-meta-analyses. A study is included if at least one analysis is included. Universe is PMIDs found in auto <code>outputs/nimads_annotation.json</code>, with manual labels sliced to that same PMID universe.</p>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Aggregate</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Macro (mean over annotations)</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>0.600</td>
            <td>0.909</td>
            <td>0.694</td>
            <td>0.710</td>
          </tr>
          <tr>
            <td>Micro (pooled confusion)</td>
            <td>308</td>
            <td>174</td>
            <td>20</td>
            <td>168</td>
            <td>0.639</td>
            <td>0.939</td>
            <td>0.760</td>
            <td>0.710</td>
          </tr>
          <tr>
            <td>Matched analyses micro (pooled confusion)</td>
            <td>857</td>
            <td>108</td>
            <td>132</td>
            <td>15</td>
            <td>0.888</td>
            <td>0.867</td>
            <td>0.877</td>
            <td>0.784</td>
          </tr>
        </tbody>
      </table>
    </div>
  </header>
  <section>
    <h2>Per-Annotation Study-Level Metrics</h2>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Annotation</th>
            <th>Auto PMID Universe</th>
            <th>Manual Studies+</th>
            <th>Predicted Studies+</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
            <th>PRF Plot</th>
            <th>Confusion Plot</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>social_processing_all</td><td>134</td><td>134</td><td>133</td><td>133</td><td>0</td><td>1</td><td>0</td><td>1.000</td><td>0.993</td><td>0.996</td><td>0.993</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:100.0%"></div></div><span class="metric-val">1.000</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:99.3%"></div></div><span class="metric-val">0.993</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:99.6%"></div></div><span class="metric-val">0.996</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:99.254%" title="TP=133"></span><span class="seg seg-fp" style="width:0.000%" title="FP=0"></span><span class="seg seg-fn" style="width:0.746%" title="FN=1"></span><span class="seg seg-tn" style="width:0.000%" title="TN=0"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>affiliation_attachment</td><td>134</td><td>19</td><td>71</td><td>17</td><td>54</td><td>2</td><td>61</td><td>0.239</td><td>0.895</td><td>0.378</td><td>0.582</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:23.9%"></div></div><span class="metric-val">0.239</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:89.5%"></div></div><span class="metric-val">0.895</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:37.8%"></div></div><span class="metric-val">0.378</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:12.687%" title="TP=17"></span><span class="seg seg-fp" style="width:40.299%" title="FP=54"></span><span class="seg seg-fn" style="width:1.493%" title="FN=2"></span><span class="seg seg-tn" style="width:45.522%" title="TN=61"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_others</td><td>134</td><td>74</td><td>127</td><td>72</td><td>55</td><td>2</td><td>5</td><td>0.567</td><td>0.973</td><td>0.716</td><td>0.575</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:56.7%"></div></div><span class="metric-val">0.567</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:97.3%"></div></div><span class="metric-val">0.973</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:71.6%"></div></div><span class="metric-val">0.716</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:53.731%" title="TP=72"></span><span class="seg seg-fp" style="width:41.045%" title="FP=55"></span><span class="seg seg-fn" style="width:1.493%" title="FN=2"></span><span class="seg seg-tn" style="width:3.731%" title="TN=5"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_self</td><td>134</td><td>44</td><td>50</td><td>34</td><td>16</td><td>10</td><td>74</td><td>0.680</td><td>0.773</td><td>0.723</td><td>0.806</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:68.0%"></div></div><span class="metric-val">0.680</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:77.3%"></div></div><span class="metric-val">0.773</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:72.3%"></div></div><span class="metric-val">0.723</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:25.373%" title="TP=34"></span><span class="seg seg-fp" style="width:11.940%" title="FP=16"></span><span class="seg seg-fn" style="width:7.463%" title="FN=10"></span><span class="seg seg-tn" style="width:55.224%" title="TN=74"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>social_communication</td><td>134</td><td>57</td><td>101</td><td>52</td><td>49</td><td>5</td><td>28</td><td>0.515</td><td>0.912</td><td>0.658</td><td>0.597</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:51.5%"></div></div><span class="metric-val">0.515</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:91.2%"></div></div><span class="metric-val">0.912</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:65.8%"></div></div><span class="metric-val">0.658</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:38.806%" title="TP=52"></span><span class="seg seg-fp" style="width:36.567%" title="FP=49"></span><span class="seg seg-fn" style="width:3.731%" title="FN=5"></span><span class="seg seg-tn" style="width:20.896%" title="TN=28"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr>
        </tbody>
      </table>
    </div>
  </section>
  <section>
    <h2>Per-Annotation Matched-Analysis Metrics</h2>
    <p>Mirrors the per-report analysis row: universe is manual analyses that have an assigned auto match; positives are accepted fuzzy matches.</p>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Annotation</th>
            <th>Matched Manual Universe</th>
            <th>Manual Accepted+</th>
            <th>Predicted+</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
            <th>PRF Plot</th>
            <th>Confusion Plot</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>social_processing_all</td><td>475</td><td>422</td><td>458</td><td>407</td><td>51</td><td>15</td><td>2</td><td>0.889</td><td>0.964</td><td>0.925</td><td>0.861</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:88.9%"></div></div><span class="metric-val">0.889</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:96.4%"></div></div><span class="metric-val">0.964</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:92.5%"></div></div><span class="metric-val">0.925</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:85.684%" title="TP=407"></span><span class="seg seg-fp" style="width:10.737%" title="FP=51"></span><span class="seg seg-fn" style="width:3.158%" title="FN=15"></span><span class="seg seg-tn" style="width:0.421%" title="TN=2"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>affiliation_attachment</td><td>56</td><td>51</td><td>43</td><td>38</td><td>5</td><td>13</td><td>0</td><td>0.884</td><td>0.745</td><td>0.809</td><td>0.679</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:88.4%"></div></div><span class="metric-val">0.884</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:74.5%"></div></div><span class="metric-val">0.745</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:80.9%"></div></div><span class="metric-val">0.809</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:67.857%" title="TP=38"></span><span class="seg seg-fp" style="width:8.929%" title="FP=5"></span><span class="seg seg-fn" style="width:23.214%" title="FN=13"></span><span class="seg seg-tn" style="width:0.000%" title="TN=0"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_others</td><td>239</td><td>215</td><td>208</td><td>187</td><td>21</td><td>28</td><td>3</td><td>0.899</td><td>0.870</td><td>0.884</td><td>0.795</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:89.9%"></div></div><span class="metric-val">0.899</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:87.0%"></div></div><span class="metric-val">0.870</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:88.4%"></div></div><span class="metric-val">0.884</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:78.243%" title="TP=187"></span><span class="seg seg-fp" style="width:8.787%" title="FP=21"></span><span class="seg seg-fn" style="width:11.715%" title="FN=28"></span><span class="seg seg-tn" style="width:1.255%" title="TN=3"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_self</td><td>140</td><td>124</td><td>76</td><td>67</td><td>9</td><td>57</td><td>7</td><td>0.882</td><td>0.540</td><td>0.670</td><td>0.529</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:88.2%"></div></div><span class="metric-val">0.882</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:54.0%"></div></div><span class="metric-val">0.540</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:67.0%"></div></div><span class="metric-val">0.670</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:47.857%" title="TP=67"></span><span class="seg seg-fp" style="width:6.429%" title="FP=9"></span><span class="seg seg-fn" style="width:40.714%" title="FN=57"></span><span class="seg seg-tn" style="width:5.000%" title="TN=7"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>social_communication</td><td>202</td><td>177</td><td>180</td><td>158</td><td>22</td><td>19</td><td>3</td><td>0.878</td><td>0.893</td><td>0.885</td><td>0.797</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:87.8%"></div></div><span class="metric-val">0.878</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:89.3%"></div></div><span class="metric-val">0.893</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:88.5%"></div></div><span class="metric-val">0.885</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:78.218%" title="TP=158"></span><span class="seg seg-fp" style="width:10.891%" title="FP=22"></span><span class="seg seg-fn" style="width:9.406%" title="FN=19"></span><span class="seg seg-tn" style="width:1.485%" title="TN=3"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr>
        </tbody>
      </table>
    </div>
  </section>
</body>
</html>
