<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Overall Sub-Meta-Analysis Summary</title>
  <style>
    :root {
      --bg: #f7f6f2;
      --panel: #ffffff;
      --ink: #1d2730;
      --line: #d8dde3;
    }
    body { margin: 0; padding: 1.25rem; font-family: "IBM Plex Sans", "Segoe UI", sans-serif; background: var(--bg); color: var(--ink); }
    header, section { background: var(--panel); border: 1px solid var(--line); border-radius: 10px; padding: 1rem; margin-bottom: 1rem; }
    .table-wrap { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
    th, td { border: 1px solid var(--line); padding: 0.45rem; vertical-align: top; text-align: left; }
    th { background: #edf2f5; }
    .metric-bars { min-width: 250px; }
    .metric-row { display: grid; grid-template-columns: 22px 1fr 46px; gap: 0.35rem; align-items: center; margin-bottom: 0.2rem; }
    .metric-label { font-weight: 600; font-size: 0.82rem; }
    .metric-val { font-size: 0.82rem; text-align: right; }
    .bar { height: 0.55rem; border: 1px solid var(--line); border-radius: 999px; overflow: hidden; background: #fbfcfe; }
    .fill { height: 100%; }
    .fill-p { background: #3b82f6; }
    .fill-r { background: #16a34a; }
    .fill-f1 { background: #f59e0b; }
    .confusion-plot { min-width: 220px; }
    .stack-bar { width: 100%; height: 0.78rem; border: 1px solid var(--line); border-radius: 999px; overflow: hidden; background: #fbfcfe; }
    .seg { display: inline-block; height: 100%; }
    .seg-tp { background: #16a34a; }
    .seg-fp { background: #dc2626; }
    .seg-fn { background: #ea580c; }
    .seg-tn { background: #64748b; }
    .legend { margin-top: 0.25rem; font-size: 0.77rem; color: #435164; display: flex; gap: 0.55rem; }
    .lg::before { content: ""; display: inline-block; width: 0.55rem; height: 0.55rem; margin-right: 0.2rem; border-radius: 50%; vertical-align: -1px; }
    .lg-tp::before { background: #16a34a; }
    .lg-fp::before { background: #dc2626; }
    .lg-fn::before { background: #ea580c; }
    .lg-tn::before { background: #64748b; }
    .confusion-plot.empty { font-size: 0.82rem; color: #5a6878; }
  </style>
</head>
<body>
  <header>
    <h1>Overall Sub-Meta-Analysis Summary</h1>
    <p>Study-level evaluation across sub-meta-analyses. A study is included if at least one analysis is included. Universe is PMIDs found in auto <code>outputs/nimads_annotation.json</code>, with manual labels sliced to that same PMID universe.</p>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Aggregate</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Macro (mean over annotations)</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>0.667</td>
            <td>0.781</td>
            <td>0.707</td>
            <td>0.764</td>
          </tr>
          <tr>
            <td>Micro (pooled confusion)</td>
            <td>262</td>
            <td>98</td>
            <td>53</td>
            <td>227</td>
            <td>0.728</td>
            <td>0.832</td>
            <td>0.776</td>
            <td>0.764</td>
          </tr>
          <tr>
            <td>Matched analyses micro (pooled confusion)</td>
            <td>404</td>
            <td>292</td>
            <td>147</td>
            <td>138</td>
            <td>0.580</td>
            <td>0.733</td>
            <td>0.648</td>
            <td>0.552</td>
          </tr>
        </tbody>
      </table>
    </div>
  </header>
  <section>
    <h2>Per-Annotation Study-Level Metrics</h2>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Annotation</th>
            <th>Auto PMID Universe</th>
            <th>Manual Studies+</th>
            <th>Predicted Studies+</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
            <th>PRF Plot</th>
            <th>Confusion Plot</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>social_processing_all</td><td>128</td><td>128</td><td>120</td><td>120</td><td>0</td><td>8</td><td>0</td><td>1.000</td><td>0.938</td><td>0.968</td><td>0.938</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:100.0%"></div></div><span class="metric-val">1.000</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:93.8%"></div></div><span class="metric-val">0.938</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:96.8%"></div></div><span class="metric-val">0.968</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:93.750%" title="TP=120"></span><span class="seg seg-fp" style="width:0.000%" title="FP=0"></span><span class="seg seg-fn" style="width:6.250%" title="FN=8"></span><span class="seg seg-tn" style="width:0.000%" title="TN=0"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>affiliation_attachment</td><td>128</td><td>18</td><td>34</td><td>13</td><td>21</td><td>5</td><td>89</td><td>0.382</td><td>0.722</td><td>0.500</td><td>0.797</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:38.2%"></div></div><span class="metric-val">0.382</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:72.2%"></div></div><span class="metric-val">0.722</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:50.0%"></div></div><span class="metric-val">0.500</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:10.156%" title="TP=13"></span><span class="seg seg-fp" style="width:16.406%" title="FP=21"></span><span class="seg seg-fn" style="width:3.906%" title="FN=5"></span><span class="seg seg-tn" style="width:69.531%" title="TN=89"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_others</td><td>128</td><td>71</td><td>103</td><td>58</td><td>45</td><td>13</td><td>12</td><td>0.563</td><td>0.817</td><td>0.667</td><td>0.547</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:56.3%"></div></div><span class="metric-val">0.563</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:81.7%"></div></div><span class="metric-val">0.817</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:66.7%"></div></div><span class="metric-val">0.667</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:45.312%" title="TP=58"></span><span class="seg seg-fp" style="width:35.156%" title="FP=45"></span><span class="seg seg-fn" style="width:10.156%" title="FN=13"></span><span class="seg seg-tn" style="width:9.375%" title="TN=12"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_self</td><td>128</td><td>43</td><td>38</td><td>27</td><td>11</td><td>16</td><td>74</td><td>0.711</td><td>0.628</td><td>0.667</td><td>0.789</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:71.1%"></div></div><span class="metric-val">0.711</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:62.8%"></div></div><span class="metric-val">0.628</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:66.7%"></div></div><span class="metric-val">0.667</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:21.094%" title="TP=27"></span><span class="seg seg-fp" style="width:8.594%" title="FP=11"></span><span class="seg seg-fn" style="width:12.500%" title="FN=16"></span><span class="seg seg-tn" style="width:57.812%" title="TN=74"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>social_communication</td><td>128</td><td>55</td><td>65</td><td>44</td><td>21</td><td>11</td><td>52</td><td>0.677</td><td>0.800</td><td>0.733</td><td>0.750</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:67.7%"></div></div><span class="metric-val">0.677</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:80.0%"></div></div><span class="metric-val">0.800</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:73.3%"></div></div><span class="metric-val">0.733</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:34.375%" title="TP=44"></span><span class="seg seg-fp" style="width:16.406%" title="FP=21"></span><span class="seg seg-fn" style="width:8.594%" title="FN=11"></span><span class="seg seg-tn" style="width:40.625%" title="TN=52"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr>
        </tbody>
      </table>
    </div>
  </section>
  <section>
    <h2>Per-Annotation Matched-Analysis Metrics</h2>
    <p>Mirrors the per-report analysis row: universe is manual analyses that have an assigned auto match; positives are accepted fuzzy matches.</p>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Annotation</th>
            <th>Matched Manual Universe</th>
            <th>Manual Accepted+</th>
            <th>Predicted+</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
            <th>PRF Plot</th>
            <th>Confusion Plot</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>social_processing_all</td><td>418</td><td>235</td><td>352</td><td>209</td><td>143</td><td>26</td><td>40</td><td>0.594</td><td>0.889</td><td>0.712</td><td>0.596</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:59.4%"></div></div><span class="metric-val">0.594</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:88.9%"></div></div><span class="metric-val">0.889</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:71.2%"></div></div><span class="metric-val">0.712</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:50.000%" title="TP=209"></span><span class="seg seg-fp" style="width:34.211%" title="FP=143"></span><span class="seg seg-fn" style="width:6.220%" title="FN=26"></span><span class="seg seg-tn" style="width:9.569%" title="TN=40"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>affiliation_attachment</td><td>48</td><td>24</td><td>25</td><td>10</td><td>15</td><td>14</td><td>9</td><td>0.400</td><td>0.417</td><td>0.408</td><td>0.396</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:40.0%"></div></div><span class="metric-val">0.400</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:41.7%"></div></div><span class="metric-val">0.417</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:40.8%"></div></div><span class="metric-val">0.408</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:20.833%" title="TP=10"></span><span class="seg seg-fp" style="width:31.250%" title="FP=15"></span><span class="seg seg-fn" style="width:29.167%" title="FN=14"></span><span class="seg seg-tn" style="width:18.750%" title="TN=9"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_others</td><td>216</td><td>126</td><td>153</td><td>89</td><td>64</td><td>37</td><td>26</td><td>0.582</td><td>0.706</td><td>0.638</td><td>0.532</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:58.2%"></div></div><span class="metric-val">0.582</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:70.6%"></div></div><span class="metric-val">0.706</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:63.8%"></div></div><span class="metric-val">0.638</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:41.204%" title="TP=89"></span><span class="seg seg-fp" style="width:29.630%" title="FP=64"></span><span class="seg seg-fn" style="width:17.130%" title="FN=37"></span><span class="seg seg-tn" style="width:12.037%" title="TN=26"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_self</td><td>129</td><td>85</td><td>49</td><td>30</td><td>19</td><td>55</td><td>25</td><td>0.612</td><td>0.353</td><td>0.448</td><td>0.426</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:61.2%"></div></div><span class="metric-val">0.612</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:35.3%"></div></div><span class="metric-val">0.353</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:44.8%"></div></div><span class="metric-val">0.448</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:23.256%" title="TP=30"></span><span class="seg seg-fp" style="width:14.729%" title="FP=19"></span><span class="seg seg-fn" style="width:42.636%" title="FN=55"></span><span class="seg seg-tn" style="width:19.380%" title="TN=25"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>social_communication</td><td>170</td><td>81</td><td>117</td><td>66</td><td>51</td><td>15</td><td>38</td><td>0.564</td><td>0.815</td><td>0.667</td><td>0.612</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:56.4%"></div></div><span class="metric-val">0.564</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:81.5%"></div></div><span class="metric-val">0.815</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:66.7%"></div></div><span class="metric-val">0.667</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:38.824%" title="TP=66"></span><span class="seg seg-fp" style="width:30.000%" title="FP=51"></span><span class="seg seg-fn" style="width:8.824%" title="FN=15"></span><span class="seg seg-tn" style="width:22.353%" title="TN=38"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr>
        </tbody>
      </table>
    </div>
  </section>
</body>
</html>
