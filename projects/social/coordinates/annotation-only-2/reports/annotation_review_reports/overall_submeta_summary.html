<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Overall Sub-Meta-Analysis Summary</title>
  <style>
    :root {
      --bg: #f7f6f2;
      --panel: #ffffff;
      --ink: #1d2730;
      --line: #d8dde3;
    }
    body { margin: 0; padding: 1.25rem; font-family: "IBM Plex Sans", "Segoe UI", sans-serif; background: var(--bg); color: var(--ink); }
    header, section { background: var(--panel); border: 1px solid var(--line); border-radius: 10px; padding: 1rem; margin-bottom: 1rem; }
    .table-wrap { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
    th, td { border: 1px solid var(--line); padding: 0.45rem; vertical-align: top; text-align: left; }
    th { background: #edf2f5; }
    .metric-bars { min-width: 250px; }
    .metric-row { display: grid; grid-template-columns: 22px 1fr 46px; gap: 0.35rem; align-items: center; margin-bottom: 0.2rem; }
    .metric-label { font-weight: 600; font-size: 0.82rem; }
    .metric-val { font-size: 0.82rem; text-align: right; }
    .bar { height: 0.55rem; border: 1px solid var(--line); border-radius: 999px; overflow: hidden; background: #fbfcfe; }
    .fill { height: 100%; }
    .fill-p { background: #3b82f6; }
    .fill-r { background: #16a34a; }
    .fill-f1 { background: #f59e0b; }
    .confusion-plot { min-width: 220px; }
    .stack-bar { width: 100%; height: 0.78rem; border: 1px solid var(--line); border-radius: 999px; overflow: hidden; background: #fbfcfe; }
    .seg { display: inline-block; height: 100%; }
    .seg-tp { background: #16a34a; }
    .seg-fp { background: #dc2626; }
    .seg-fn { background: #ea580c; }
    .seg-tn { background: #64748b; }
    .legend { margin-top: 0.25rem; font-size: 0.77rem; color: #435164; display: flex; gap: 0.55rem; }
    .lg::before { content: ""; display: inline-block; width: 0.55rem; height: 0.55rem; margin-right: 0.2rem; border-radius: 50%; vertical-align: -1px; }
    .lg-tp::before { background: #16a34a; }
    .lg-fp::before { background: #dc2626; }
    .lg-fn::before { background: #ea580c; }
    .lg-tn::before { background: #64748b; }
    .confusion-plot.empty { font-size: 0.82rem; color: #5a6878; }
  </style>
</head>
<body>
  <header>
    <h1>Overall Sub-Meta-Analysis Summary</h1>
    <p>Study-level evaluation across sub-meta-analyses. A study is included if at least one analysis is included. Universe is PMIDs found in auto <code>outputs/nimads_annotation.json</code>, with manual labels sliced to that same PMID universe.</p>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Aggregate</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Macro (mean over annotations)</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>0.617</td>
            <td>0.693</td>
            <td>0.609</td>
            <td>0.760</td>
          </tr>
          <tr>
            <td>Micro (pooled confusion)</td>
            <td>10</td>
            <td>4</td>
            <td>2</td>
            <td>9</td>
            <td>0.714</td>
            <td>0.833</td>
            <td>0.769</td>
            <td>0.760</td>
          </tr>
        </tbody>
      </table>
    </div>
  </header>
  <section>
    <h2>Per-Annotation Study-Level Metrics</h2>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Annotation</th>
            <th>Auto PMID Universe</th>
            <th>Manual Studies+</th>
            <th>Predicted Studies+</th>
            <th>TP</th>
            <th>FP</th>
            <th>FN</th>
            <th>TN</th>
            <th>Precision</th>
            <th>Recall</th>
            <th>F1</th>
            <th>Accuracy</th>
            <th>PRF Plot</th>
            <th>Confusion Plot</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>social_processing_all</td><td>5</td><td>5</td><td>4</td><td>4</td><td>0</td><td>1</td><td>0</td><td>1.000</td><td>0.800</td><td>0.889</td><td>0.800</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:100.0%"></div></div><span class="metric-val">1.000</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:80.0%"></div></div><span class="metric-val">0.800</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:88.9%"></div></div><span class="metric-val">0.889</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:80.000%" title="TP=4"></span><span class="seg seg-fp" style="width:0.000%" title="FP=0"></span><span class="seg seg-fn" style="width:20.000%" title="FN=1"></span><span class="seg seg-tn" style="width:0.000%" title="TN=0"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>affiliation_attachment</td><td>5</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>4</td><td>0.000</td><td>0.000</td><td>0.000</td><td>0.800</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:0.0%"></div></div><span class="metric-val">0.000</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:0.0%"></div></div><span class="metric-val">0.000</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:0.0%"></div></div><span class="metric-val">0.000</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:0.000%" title="TP=0"></span><span class="seg seg-fp" style="width:20.000%" title="FP=1"></span><span class="seg seg-fn" style="width:0.000%" title="FN=0"></span><span class="seg seg-tn" style="width:80.000%" title="TN=4"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_others</td><td>5</td><td>3</td><td>4</td><td>3</td><td>1</td><td>0</td><td>1</td><td>0.750</td><td>1.000</td><td>0.857</td><td>0.800</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:75.0%"></div></div><span class="metric-val">0.750</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:100.0%"></div></div><span class="metric-val">1.000</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:85.7%"></div></div><span class="metric-val">0.857</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:60.000%" title="TP=3"></span><span class="seg seg-fp" style="width:20.000%" title="FP=1"></span><span class="seg seg-fn" style="width:0.000%" title="FN=0"></span><span class="seg seg-tn" style="width:20.000%" title="TN=1"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>perception_self</td><td>5</td><td>3</td><td>2</td><td>2</td><td>0</td><td>1</td><td>2</td><td>1.000</td><td>0.667</td><td>0.800</td><td>0.800</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:100.0%"></div></div><span class="metric-val">1.000</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:66.7%"></div></div><span class="metric-val">0.667</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:80.0%"></div></div><span class="metric-val">0.800</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:40.000%" title="TP=2"></span><span class="seg seg-fp" style="width:0.000%" title="FP=0"></span><span class="seg seg-fn" style="width:20.000%" title="FN=1"></span><span class="seg seg-tn" style="width:40.000%" title="TN=2"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr><tr><td>social_communication</td><td>5</td><td>1</td><td>3</td><td>1</td><td>2</td><td>0</td><td>2</td><td>0.333</td><td>1.000</td><td>0.500</td><td>0.600</td><td><div class="metric-bars"><div class="metric-row"><span class="metric-label">P</span><div class="bar"><div class="fill fill-p" style="width:33.3%"></div></div><span class="metric-val">0.333</span></div><div class="metric-row"><span class="metric-label">R</span><div class="bar"><div class="fill fill-r" style="width:100.0%"></div></div><span class="metric-val">1.000</span></div><div class="metric-row"><span class="metric-label">F1</span><div class="bar"><div class="fill fill-f1" style="width:50.0%"></div></div><span class="metric-val">0.500</span></div></div></td><td><div class="confusion-plot"><div class="stack-bar"><span class="seg seg-tp" style="width:20.000%" title="TP=1"></span><span class="seg seg-fp" style="width:40.000%" title="FP=2"></span><span class="seg seg-fn" style="width:0.000%" title="FN=0"></span><span class="seg seg-tn" style="width:40.000%" title="TN=2"></span></div><div class="legend"><span class="lg lg-tp">TP</span><span class="lg lg-fp">FP</span><span class="lg lg-fn">FN</span><span class="lg lg-tn">TN</span></div></div></td></tr>
        </tbody>
      </table>
    </div>
  </section>
</body>
</html>
